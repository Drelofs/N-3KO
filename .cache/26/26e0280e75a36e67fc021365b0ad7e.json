{"id":"K49R","dependencies":[{"name":"/Users/julia/Documents/GitHub/N-3KO/package.json","includedInParent":true,"mtime":1557756471451},{"name":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/package.json","includedInParent":true,"mtime":1557756490182},{"name":"../../utils/Class","loc":{"line":7,"column":20},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/utils/Class.js"},{"name":"../../gameobjects/components","loc":{"line":8,"column":25},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/gameobjects/components/index.js"},{"name":"../../const","loc":{"line":9,"column":20},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/const.js"},{"name":"../../gameobjects/GameObject","loc":{"line":10,"column":25},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/gameobjects/GameObject.js"},{"name":"./StaticTilemapLayerRender","loc":{"line":11,"column":39},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayerRender.js"},{"name":"../components","loc":{"line":12,"column":32},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/components/index.js"},{"name":"../../gameobjects/components/TransformMatrix","loc":{"line":13,"column":30},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/gameobjects/components/TransformMatrix.js"},{"name":"../../renderer/webgl/Utils","loc":{"line":14,"column":20},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/tilemaps/staticlayer/StaticTilemapLayer.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/renderer/webgl/Utils.js"}],"generated":{"js":"var e=require(\"../../utils/Class\"),t=require(\"../../gameobjects/components\"),i=require(\"../../const\"),r=require(\"../../gameobjects/GameObject\"),l=require(\"./StaticTilemapLayerRender\"),s=require(\"../components\"),n=require(\"../../gameobjects/components/TransformMatrix\"),a=require(\"../../renderer/webgl/Utils\"),h=new e({Extends:r,Mixins:[t.Alpha,t.BlendMode,t.ComputedSize,t.Depth,t.Flip,t.GetBounds,t.Origin,t.Pipeline,t.ScaleMode,t.Transform,t.Visible,t.ScrollFactor,l],initialize:function(e,t,l,a,h,o){r.call(this,e,\"StaticTilemapLayer\"),this.isTilemap=!0,this.tilemap=t,this.layerIndex=l,this.layer=t.layers[l],this.layer.tilemapLayer=this,this.tileset=[],this.culledTiles=[],this.skipCull=!1,this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=s.CullTiles,this.renderer=e.sys.game.renderer,this.vertexBuffer=[],this.bufferData=[],this.vertexViewF32=[],this.vertexViewU32=[],this.dirty=[],this.vertexCount=[],this._renderOrder=0,this._tempMatrix=new n,this.gidMap=[],this.setTilesets(a),this.setAlpha(this.layer.alpha),this.setPosition(h,o),this.setOrigin(),this.setSize(t.tileWidth*this.layer.width,t.tileHeight*this.layer.height),this.updateVBOData(),this.initPipeline(\"TextureTintPipeline\"),e.sys.game.config.renderType===i.WEBGL&&e.sys.game.renderer.onContextRestored(function(){this.updateVBOData()},this)},setTilesets:function(e){var t=[],i=[],r=this.tilemap;Array.isArray(e)||(e=[e]);for(var l=0;l<e.length;l++){var s=e[l];if(\"string\"==typeof s&&(s=r.getTileset(s)),s){i.push(s);for(var n=s.firstgid,a=0;a<s.total;a++)t[n+a]=s}}this.gidMap=t,this.tileset=i},updateVBOData:function(){for(var e=0;e<this.tileset.length;e++)this.dirty[e]=!0,this.vertexCount[e]=0,this.vertexBuffer[e]=null,this.bufferData[e]=null,this.vertexViewF32[e]=null,this.vertexViewU32[e]=null;return this},upload:function(e,t){var i=this.renderer,r=i.gl,l=i.pipelines.TextureTintPipeline;if(this.dirty[t]){var s,n,a,h=this.tileset[t],o=this.layer.width,u=this.layer.height,d=h.image.source[0].width,f=h.image.source[0].height,c=this.layer.data,y=this._renderOrder,T=h.firstgid,p=h.firstgid+h.total,g=this.vertexBuffer[t],x=this.bufferData[t],v=-1,C=o*u*l.vertexSize*6;if(this.vertexCount[t]=0,null===x&&(x=new ArrayBuffer(C),this.bufferData[t]=x,this.vertexViewF32[t]=new Float32Array(x),this.vertexViewU32[t]=new Uint32Array(x)),0===y)for(n=0;n<u;n++)for(a=0;a<o;a++)!(s=c[n][a])||s.index<T||s.index>p||!s.visible||(v=this.batchTile(v,s,h,d,f,e,t));else if(1===y)for(n=0;n<u;n++)for(a=o-1;a>=0;a--)!(s=c[n][a])||s.index<T||s.index>p||!s.visible||(v=this.batchTile(v,s,h,d,f,e,t));else if(2===y)for(n=u-1;n>=0;n--)for(a=0;a<o;a++)!(s=c[n][a])||s.index<T||s.index>p||!s.visible||(v=this.batchTile(v,s,h,d,f,e,t));else if(3===y)for(n=u-1;n>=0;n--)for(a=o-1;a>=0;a--)!(s=c[n][a])||s.index<T||s.index>p||!s.visible||(v=this.batchTile(v,s,h,d,f,e,t));this.dirty[t]=!1,null===g?(g=i.createVertexBuffer(x,r.STATIC_DRAW),this.vertexBuffer[t]=g):(i.setVertexBuffer(g),r.bufferSubData(r.ARRAY_BUFFER,0,x))}return this},batchTile:function(e,t,i,r,l,s,n){var h=i.getTileTextureCoordinates(t.index);if(!h)return e;var o=i.tileWidth,u=i.tileHeight,d=o/2,f=u/2,c=h.x/r,y=h.y/l,T=(h.x+o)/r,p=(h.y+u)/l,g=this._tempMatrix,x=-d,v=-f;t.flipX&&(o*=-1,x+=i.tileWidth),t.flipY&&(u*=-1,v+=i.tileHeight);var C=x+o,b=v+u;g.applyITRS(d+t.pixelX,f+t.pixelY,t.rotation,1,1);var m=a.getTintAppendFloatAlpha(16777215,s.alpha*this.alpha*t.alpha),w=g.getX(x,v),W=g.getY(x,v),A=g.getX(x,b),B=g.getY(x,b),F=g.getX(C,b),Y=g.getY(C,b),X=g.getX(C,v),S=g.getY(C,v);s.roundPixels&&(w=Math.round(w),W=Math.round(W),A=Math.round(A),B=Math.round(B),F=Math.round(F),Y=Math.round(Y),X=Math.round(X),S=Math.round(S));var M=this.vertexViewF32[n],V=this.vertexViewU32[n];return M[++e]=w,M[++e]=W,M[++e]=c,M[++e]=y,M[++e]=0,V[++e]=m,M[++e]=A,M[++e]=B,M[++e]=c,M[++e]=p,M[++e]=0,V[++e]=m,M[++e]=F,M[++e]=Y,M[++e]=T,M[++e]=p,M[++e]=0,V[++e]=m,M[++e]=w,M[++e]=W,M[++e]=c,M[++e]=y,M[++e]=0,V[++e]=m,M[++e]=F,M[++e]=Y,M[++e]=T,M[++e]=p,M[++e]=0,V[++e]=m,M[++e]=X,M[++e]=S,M[++e]=T,M[++e]=y,M[++e]=0,V[++e]=m,this.vertexCount[n]+=6,e},setRenderOrder:function(e){if(\"string\"==typeof e&&(e=[\"right-down\",\"left-down\",\"right-up\",\"left-up\"].indexOf(e)),e>=0&&e<4){this._renderOrder=e;for(var t=0;t<this.tileset.length;t++)this.dirty[t]=!0}return this},calculateFacesAt:function(e,t){return s.CalculateFacesAt(e,t,this.layer),this},calculateFacesWithin:function(e,t,i,r){return s.CalculateFacesWithin(e,t,i,r,this.layer),this},createFromTiles:function(e,t,i,r,l){return s.CreateFromTiles(e,t,i,r,l,this.layer)},cull:function(e){return this.cullCallback(this.layer,e,this.culledTiles)},setSkipCull:function(e){return void 0===e&&(e=!0),this.skipCull=e,this},setCullPadding:function(e,t){return void 0===e&&(e=1),void 0===t&&(t=1),this.cullPaddingX=e,this.cullPaddingY=t,this},findByIndex:function(e,t,i){return s.FindByIndex(e,t,i,this.layer)},findTile:function(e,t,i,r,l,n,a){return s.FindTile(e,t,i,r,l,n,a,this.layer)},filterTiles:function(e,t,i,r,l,n,a){return s.FilterTiles(e,t,i,r,l,n,a,this.layer)},forEachTile:function(e,t,i,r,l,n,a){return s.ForEachTile(e,t,i,r,l,n,a,this.layer),this},getTileAt:function(e,t,i){return s.GetTileAt(e,t,i,this.layer)},getTileAtWorldXY:function(e,t,i,r){return s.GetTileAtWorldXY(e,t,i,r,this.layer)},getTilesWithin:function(e,t,i,r,l){return s.GetTilesWithin(e,t,i,r,l,this.layer)},getTilesWithinWorldXY:function(e,t,i,r,l,n){return s.GetTilesWithinWorldXY(e,t,i,r,l,n,this.layer)},getTilesWithinShape:function(e,t,i){return s.GetTilesWithinShape(e,t,i,this.layer)},hasTileAt:function(e,t){return s.HasTileAt(e,t,this.layer)},hasTileAtWorldXY:function(e,t,i){return s.HasTileAtWorldXY(e,t,i,this.layer)},renderDebug:function(e,t){return s.RenderDebug(e,t,this.layer),this},setCollision:function(e,t,i){return s.SetCollision(e,t,i,this.layer),this},setCollisionBetween:function(e,t,i,r){return s.SetCollisionBetween(e,t,i,r,this.layer),this},setCollisionByProperty:function(e,t,i){return s.SetCollisionByProperty(e,t,i,this.layer),this},setCollisionByExclusion:function(e,t,i){return s.SetCollisionByExclusion(e,t,i,this.layer),this},setTileIndexCallback:function(e,t,i){return s.SetTileIndexCallback(e,t,i,this.layer),this},setCollisionFromCollisionGroup:function(e,t){return s.SetCollisionFromCollisionGroup(e,t,this.layer),this},setTileLocationCallback:function(e,t,i,r,l,n){return s.SetTileLocationCallback(e,t,i,r,l,n,this.layer),this},tileToWorldX:function(e,t){return s.TileToWorldX(e,t,this.layer)},tileToWorldY:function(e,t){return s.TileToWorldY(e,t,this.layer)},tileToWorldXY:function(e,t,i,r){return s.TileToWorldXY(e,t,i,r,this.layer)},worldToTileX:function(e,t,i){return s.WorldToTileX(e,t,i,this.layer)},worldToTileY:function(e,t,i){return s.WorldToTileY(e,t,i,this.layer)},worldToTileXY:function(e,t,i,r,l){return s.WorldToTileXY(e,t,i,r,l,this.layer)},destroy:function(){this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null;for(var e=0;e<this.tileset.length;e++)this.dirty[e]=!0,this.vertexCount[e]=0,this.vertexBuffer[e]=null,this.bufferData[e]=null,this.vertexViewF32[e]=null,this.vertexViewU32[e]=null;this.gidMap=[],this.tileset=[],r.prototype.destroy.call(this)}});module.exports=h;"},"sourceMaps":null,"error":null,"hash":"19f360d4a2f404b38a88cd0a7c810cbd","cacheData":{"env":{}}}