{"id":"c43s","dependencies":[{"name":"/Users/julia/Documents/GitHub/N-3KO/package.json","includedInParent":true,"mtime":1557756471451},{"name":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/package.json","includedInParent":true,"mtime":1557756490182},{"name":"./AdInstance","loc":{"line":9,"column":25},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/AdInstance.js"},{"name":"../../../src/utils/Class","loc":{"line":10,"column":20},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/utils/Class.js"},{"name":"../../../src/data/DataManager","loc":{"line":11,"column":26},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/src/data/DataManager.js"},{"name":"eventemitter3","loc":{"line":12,"column":27},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/eventemitter3/index.js"},{"name":"./Leaderboard","loc":{"line":13,"column":26},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/Leaderboard.js"},{"name":"./Product","loc":{"line":14,"column":22},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/Product.js"},{"name":"./Purchase","loc":{"line":15,"column":23},"parent":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/FacebookInstantGamesPlugin.js","resolved":"/Users/julia/Documents/GitHub/N-3KO/node_modules/phaser/plugins/fbinstant/src/Purchase.js"}],"generated":{"js":"var t=require(\"./AdInstance\"),e=require(\"../../../src/utils/Class\"),n=require(\"../../../src/data/DataManager\"),s=require(\"eventemitter3\"),a=require(\"./Leaderboard\"),i=require(\"./Product\"),r=require(\"./Purchase\"),c=new e({Extends:s,initialize:function(t){s.call(this),this.game=t,this.data=new n(this),this.on(\"setdata\",this.setDataHandler,this),this.on(\"changedata\",this.changeDataHandler,this),this.hasLoaded=!1,this.dataLocked=!1,this.supportedAPIs=[],this.entryPoint=\"\",this.entryPointData=null,this.contextID=null,this.contextType=null,this.locale=null,this.platform=null,this.version=null,this.playerID=null,this.playerName=null,this.playerPhotoURL=null,this.playerCanSubscribeBot=!1,this.paymentsReady=!1,this.catalog=[],this.purchases=[],this.leaderboards={},this.ads=[]},setDataHandler:function(t,e,n){if(!this.dataLocked){var s={};s[e]=n;var a=this;FBInstant.player.setDataAsync(s).then(function(){a.emit(\"savedata\",s)})}},changeDataHandler:function(t,e,n){if(!this.dataLocked){var s={};s[e]=n;var a=this;FBInstant.player.setDataAsync(s).then(function(){a.emit(\"savedata\",s)})}},showLoadProgress:function(t){return t.load.on(\"progress\",function(t){this.hasLoaded||FBInstant.setLoadingProgress(100*t)},this),t.load.on(\"complete\",function(){this.hasLoaded||(this.hasLoaded=!0,FBInstant.startGameAsync().then(this.gameStarted.bind(this)))},this),this},gameStarted:function(){var t=FBInstant.getSupportedAPIs(),e={},n=function(t){return t[1].toUpperCase()};t.forEach(function(t){t=t.replace(/\\../g,n),e[t]=!0}),this.supportedAPIs=e,this.getID(),this.getType(),this.getLocale(),this.getPlatform(),this.getSDKVersion(),this.getPlayerID(),this.getPlayerName(),this.getPlayerPhotoURL();var s=this;FBInstant.onPause(function(){s.emit(\"pause\")}),FBInstant.getEntryPointAsync().then(function(t){s.entryPoint=t,s.entryPointData=FBInstant.getEntryPointData(),s.emit(\"startgame\")}).catch(function(t){console.warn(t)}),this.supportedAPIs.paymentsPurchaseAsync&&FBInstant.payments.onReady(function(){s.paymentsReady=!0}).catch(function(t){console.warn(t)})},checkAPI:function(t){return!!this.supportedAPIs[t]},getID:function(){return!this.contextID&&this.supportedAPIs.contextGetID&&(this.contextID=FBInstant.context.getID()),this.contextID},getType:function(){return!this.contextType&&this.supportedAPIs.contextGetType&&(this.contextType=FBInstant.context.getType()),this.contextType},getLocale:function(){return!this.locale&&this.supportedAPIs.getLocale&&(this.locale=FBInstant.getLocale()),this.locale},getPlatform:function(){return!this.platform&&this.supportedAPIs.getPlatform&&(this.platform=FBInstant.getPlatform()),this.platform},getSDKVersion:function(){return!this.version&&this.supportedAPIs.getSDKVersion&&(this.version=FBInstant.getSDKVersion()),this.version},getPlayerID:function(){return!this.playerID&&this.supportedAPIs.playerGetID&&(this.playerID=FBInstant.player.getID()),this.playerID},getPlayerName:function(){return!this.playerName&&this.supportedAPIs.playerGetName&&(this.playerName=FBInstant.player.getName()),this.playerName},getPlayerPhotoURL:function(){return!this.playerPhotoURL&&this.supportedAPIs.playerGetPhoto&&(this.playerPhotoURL=FBInstant.player.getPhoto()),this.playerPhotoURL},loadPlayerPhoto:function(t,e){return this.playerPhotoURL&&(t.load.setCORS(\"anonymous\"),t.load.image(e,this.playerPhotoURL),t.load.once(\"filecomplete-image-\"+e,function(){this.emit(\"photocomplete\",e)},this),t.load.start()),this},canSubscribeBot:function(){if(this.supportedAPIs.playerCanSubscribeBotAsync){var t=this;FBInstant.player.canSubscribeBotAsync().then(function(){t.playerCanSubscribeBot=!0,t.emit(\"cansubscribebot\")}).catch(function(e){t.emit(\"cansubscribebotfail\",e)})}else this.emit(\"cansubscribebotfail\");return this},subscribeBot:function(){if(this.playerCanSubscribeBot){var t=this;FBInstant.player.subscribeBotAsync().then(function(){t.emit(\"subscribebot\")}).catch(function(e){t.emit(\"subscribebotfail\",e)})}else this.emit(\"subscribebotfail\");return this},getData:function(t){if(!this.checkAPI(\"playerGetDataAsync\"))return this;Array.isArray(t)||(t=[t]);var e=this;return FBInstant.player.getDataAsync(t).then(function(t){for(var n in e.dataLocked=!0,t)e.data.set(n,t[n]);e.dataLocked=!1,e.emit(\"getdata\",t)}),this},saveData:function(t){if(!this.checkAPI(\"playerSetDataAsync\"))return this;var e=this;return FBInstant.player.setDataAsync(t).then(function(){e.emit(\"savedata\",t)}).catch(function(t){e.emit(\"savedatafail\",t)}),this},flushData:function(){if(!this.checkAPI(\"playerFlushDataAsync\"))return this;var t=this;return FBInstant.player.flushDataAsync().then(function(){t.emit(\"flushdata\")}).catch(function(e){t.emit(\"flushdatafail\",e)}),this},getStats:function(t){if(!this.checkAPI(\"playerGetStatsAsync\"))return this;var e=this;return FBInstant.player.getStatsAsync(t).then(function(t){e.emit(\"getstats\",t)}).catch(function(t){e.emit(\"getstatsfail\",t)}),this},saveStats:function(t){if(!this.checkAPI(\"playerSetStatsAsync\"))return this;var e={};for(var n in t)\"number\"==typeof t[n]&&(e[n]=t[n]);var s=this;return FBInstant.player.setStatsAsync(e).then(function(){s.emit(\"savestats\",e)}).catch(function(t){s.emit(\"savestatsfail\",t)}),this},incStats:function(t){if(!this.checkAPI(\"playerIncrementStatsAsync\"))return this;var e={};for(var n in t)\"number\"==typeof t[n]&&(e[n]=t[n]);var s=this;return FBInstant.player.incrementStatsAsync(e).then(function(t){s.emit(\"incstats\",t)}).catch(function(t){s.emit(\"incstatsfail\",t)}),this},saveSession:function(t){return this.checkAPI(\"setSessionData\")?(JSON.stringify(t).length<=1e3?FBInstant.setSessionData(t):console.warn(\"Session data too long. Max 1000 chars.\"),this):this},openShare:function(t,e,n,s){return this._share(\"SHARE\",t,e,n,s)},openInvite:function(t,e,n,s){return this._share(\"INVITE\",t,e,n,s)},openRequest:function(t,e,n,s){return this._share(\"REQUEST\",t,e,n,s)},openChallenge:function(t,e,n,s){return this._share(\"CHALLENGE\",t,e,n,s)},_share:function(t,e,n,s,a){if(!this.checkAPI(\"shareAsync\"))return this;if(void 0===a&&(a={}),n)var i=this.game.textures.getBase64(n,s);var r={intent:t,image:i,text:e,data:a},c=this;return FBInstant.shareAsync(r).then(function(){c.emit(\"resume\")}),this},isSizeBetween:function(t,e){return this.checkAPI(\"contextIsSizeBetween\")?FBInstant.context.isSizeBetween(t,e):this},switchContext:function(t){if(!this.checkAPI(\"contextSwitchAsync\"))return this;if(t!==this.contextID){var e=this;FBInstant.context.switchAsync(t).then(function(){e.contextID=FBInstant.context.getID(),e.emit(\"switch\",e.contextID)}).catch(function(t){e.emit(\"switchfail\",t)})}return this},chooseContext:function(t){if(!this.checkAPI(\"contextChooseAsync\"))return this;var e=this;return FBInstant.context.chooseAsync(t).then(function(){e.contextID=FBInstant.context.getID(),e.emit(\"choose\",e.contextID)}).catch(function(t){e.emit(\"choosefail\",t)}),this},createContext:function(t){if(!this.checkAPI(\"contextCreateAsync\"))return this;var e=this;return FBInstant.context.createAsync(t).then(function(){e.contextID=FBInstant.context.getID(),e.emit(\"create\",e.contextID)}).catch(function(t){e.emit(\"createfail\",t)}),this},getPlayers:function(){if(!this.checkAPI(\"playerGetConnectedPlayersAsync\"))return this;var t=this;return FBInstant.player.getConnectedPlayersAsync().then(function(e){t.emit(\"players\",e)}).catch(function(e){t.emit(\"playersfail\",e)}),this},getCatalog:function(){if(!this.paymentsReady)return this;var t=this,e=this.catalog;return FBInstant.payments.getCatalogAsync().then(function(n){e=[],n.forEach(function(t){e.push(i(t))}),t.emit(\"getcatalog\",e)}).catch(function(e){t.emit(\"getcatalogfail\",e)}),this},purchase:function(t,e){if(!this.paymentsReady)return this;var n={productID:t};e&&(n.developerPayload=e);var s=this;return FBInstant.payments.purchaseAsync(n).then(function(t){var e=r(t);s.emit(\"purchase\",e)}).catch(function(t){s.emit(\"purchasefail\",t)}),this},getPurchases:function(){if(!this.paymentsReady)return this;var t=this,e=this.purchases;return FBInstant.payments.getPurchasesAsync().then(function(n){e=[],n.forEach(function(t){e.push(r(t))}),t.emit(\"getpurchases\",e)}).catch(function(e){t.emit(\"getpurchasesfail\",e)}),this},consumePurchases:function(t){if(!this.paymentsReady)return this;var e=this;return FBInstant.payments.consumePurchaseAsync(t).then(function(){e.emit(\"consumepurchase\",t)}).catch(function(t){e.emit(\"consumepurchasefail\",t)}),this},update:function(t,e,n,s,a,i){return this._update(\"CUSTOM\",t,e,n,s,a,i)},updateLeaderboard:function(t,e,n,s,a,i){return this._update(\"LEADERBOARD\",t,e,n,s,a,i)},_update:function(t,e,n,s,a,i,r){if(!this.checkAPI(\"shareAsync\"))return this;if(void 0===e&&(e=\"\"),\"string\"==typeof n&&(n={default:n}),void 0===r&&(r={}),s)var c=this.game.textures.getBase64(s,a);var o={action:t,cta:e,image:c,text:n,template:i,data:r,strategy:\"IMMEDIATE\",notification:\"NO_PUSH\"},h=this;return FBInstant.updateAsync(o).then(function(){h.emit(\"update\")}).catch(function(t){h.emit(\"updatefail\",t)}),this},switchGame:function(t,e){if(!this.checkAPI(\"switchGameAsync\"))return this;if(e&&JSON.stringify(e).length>1e3)return console.warn(\"Switch Game data too long. Max 1000 chars.\"),this;var n=this;return FBInstant.switchGameAsync(t,e).then(function(){n.emit(\"switchgame\",t)}).catch(function(t){n.emit(\"switchgamefail\",t)}),this},createShortcut:function(){var t=this;return FBInstant.canCreateShortcutAsync().then(function(e){e&&FBInstant.createShortcutAsync().then(function(){t.emit(\"shortcutcreated\")}).catch(function(e){t.emit(\"shortcutfailed\",e)})}),this},quit:function(){FBInstant.quit()},log:function(t,e,n){return this.checkAPI(\"logEvent\")?(void 0===n&&(n={}),t.length>=2&&t.length<=40&&FBInstant.logEvent(t,parseFloat(e),n),this):this},preloadAds:function(e){if(!this.checkAPI(\"getInterstitialAdAsync\"))return this;var n;Array.isArray(e)||(e=[e]);var s=this,a=0;for(n=0;n<this.ads.length;n++)this.ads[n].shown||a++;if(a+e.length>=3)return console.warn(\"Too many AdInstances. Show an ad before loading more\"),this;for(n=0;n<e.length;n++){var i,r=e[n];FBInstant.getInterstitialAdAsync(r).then(function(t){return i=t,t.loadAsync()}).then(function(){var e=t(r,i,!1);s.ads.push(e),s.emit(\"adloaded\",e)}).catch(function(t){\"ADS_NO_FILL\"===t.code?s.emit(\"adsnofill\",r):\"ADS_FREQUENT_LOAD\"===t.code?s.emit(\"adsfrequentload\",r):console.warn(t)})}return this},preloadVideoAds:function(e){if(!this.checkAPI(\"getRewardedVideoAsync\"))return this;var n;Array.isArray(e)||(e=[e]);var s=this,a=0;for(n=0;n<this.ads.length;n++)this.ads[n].shown||a++;if(a+e.length>=3)return console.warn(\"Too many AdInstances. Show an ad before loading more\"),this;for(n=0;n<e.length;n++){var i,r=e[n];FBInstant.getRewardedVideoAsync(r).then(function(t){return i=t,t.loadAsync()}).then(function(){var e=t(r,i,!0);s.ads.push(e),s.emit(\"adloaded\",e)}).catch(function(t){\"ADS_NO_FILL\"===t.code?s.emit(\"adsnofill\",r):\"ADS_FREQUENT_LOAD\"===t.code?s.emit(\"adsfrequentload\",r):console.warn(t)})}return this},showAd:function(t){for(var e=this,n=0;n<this.ads.length;n++){var s=this.ads[n];s.placementID===t&&s.instance.showAsync().then(function(){s.shown=!0,e.emit(\"adfinished\",s)}).catch(function(t){\"ADS_NOT_LOADED\"===t.code?e.emit(\"adsnotloaded\",s):\"RATE_LIMITED\"===t.code&&e.emit(\"adratelimited\",s),e.emit(\"adshowerror\",t,s)})}return this},showVideo:function(t){for(var e=this,n=0;n<this.ads.length;n++){var s=this.ads[n];s.placementID===t&&s.video&&s.instance.showAsync().then(function(){s.shown=!0,e.emit(\"adfinished\",s)}).catch(function(t){\"ADS_NOT_LOADED\"===t.code?e.emit(\"adsnotloaded\",s):\"RATE_LIMITED\"===t.code&&e.emit(\"adratelimited\",s),e.emit(\"adshowerror\",t,s)})}return this},matchPlayer:function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),!this.checkAPI(\"matchPlayerAsync\"))return this;var n=this;return FBInstant.matchPlayerAsync(t,e).then(function(){n.getID(),n.getType(),n.emit(\"matchplayer\",n.contextID,n.contextType)}),this},getLeaderboard:function(t){if(!this.checkAPI(\"getLeaderboardAsync\"))return this;var e=this;return FBInstant.getLeaderboardAsync(t).then(function(n){var s=new a(e,n);e.leaderboards[t]=s,e.emit(\"getleaderboard\",s)}).catch(function(t){console.warn(t)}),this},destroy:function(){FBInstant.quit(),this.data.destroy(),this.removeAllListeners(),this.catalog=[],this.purchases=[],this.leaderboards=[],this.ads=[],this.game=null}});module.exports=c;"},"sourceMaps":null,"error":null,"hash":"b7f594ae1f5044d0e3c63c322919869c","cacheData":{"env":{}}}